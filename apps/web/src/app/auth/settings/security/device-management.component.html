<div class="tabbed-content">
  <h2>
    {{ "devices" | i18n }}
    <i class="bwi bwi-question-circle tw-h-5 tw-w-5 bwi-color-primary" aria-hidden="true"></i>
  </h2>
  <p>{{ "deviceListDescription" | i18n }}</p>

  <bit-table-scroll [dataSource]="dataSource" [rowSize]="1">
    <ng-container header>
      <th
        *ngFor="let col of columnConfig"
        [class]="col.headerClass"
        bitCell
        [bitSortable]="col.sortable ? col.name : null"
        [default]="col.name === 'displayName' ? 'desc' : null"
        scope="col"
        role="columnheader"
      >
        {{ col.title }}
      </th>
      <th bitCell scope="col" role="columnheader"></th>
    </ng-container>
    <ng-template bitRowDef let-row>
      <td bitCell class="tw-flex tw-gap-2">
        <div class="tw-flex tw-items-center tw-justify-center tw-w-10">
          <i [class]="getDeviceIcon(row.type)" class="bwi-lg" aria-hidden="true"></i>
        </div>
        <div>
          {{ row.displayName }}
          <span *ngIf="row.trusted" class="tw-text-sm tw-text-muted tw-block">
            {{ "trusted" | i18n }}
          </span>
        </div>
      </td>
      <td bitCell>
        <span *ngIf="isCurrentDevice(row)" bitBadge variant="primary">{{
          "currentSession" | i18n
        }}</span>
        <span *ngIf="hasPendingAuthRequest(row)" bitBadge variant="warning">{{
          "requestPending" | i18n
        }}</span>
      </td>
      <td bitCell>{{ row.firstLogin | date: "medium" }}</td>
      <td bitCell>
        <button
          type="button"
          bitIconButton="bwi-ellipsis-v"
          [bitMenuTriggerFor]="optionsMenu"
        ></button>
        <bit-menu #optionsMenu>
          <button
            type="button"
            bitMenuItem
            (click)="approveDevice(row)"
            *ngIf="row.loginStatus && !isCurrentDevice(row)"
          >
            <i class="bwi bwi-check" aria-hidden="true"></i>
            {{ "approveRequest" | i18n }}
          </button>
          <button
            type="button"
            bitMenuItem
            (click)="logOutDevice(row)"
            [disabled]="isCurrentDevice(row)"
          >
            <i aria-hidden="true" class="bwi bwi-fw bwi-sign-out"></i>
            {{ "logOut" | i18n }}
          </button>
          <button
            type="button"
            bitMenuItem
            (click)="removeDevice(row)"
            [disabled]="isCurrentDevice(row)"
          >
            <span [class]="isCurrentDevice(row) ? 'tw-text-muted' : 'tw-text-danger'">
              <i class="bwi bwi-trash" aria-hidden="true"></i>
              {{ "remove" | i18n }}
            </span>
          </button>
        </bit-menu>
      </td>
    </ng-template>
  </bit-table-scroll>
</div>
