<div class="tabbed-content">
  <h2>
    {{ "devices" | i18n }}
    <i class="bwi bwi-question-circle tw-h-5 tw-w-5 bwi-color-primary" aria-hidden="true"></i>
  </h2>
  <p>{{ "deviceListDescription" | i18n }}</p>

  <bit-table [dataSource]="dataSource">
    <ng-container header>
      <tr>
        <th
          *ngFor="let col of columnConfig"
          [class]="col.headerClass"
          bitCell
          [bitSortable]="col.sortable ? col.name : null"
          [default]="col.name === 'displayName' ? 'desc' : null"
          scope="col"
          role="columnheader"
        >
          {{ col.title }}
        </th>
        <th bitCell scope="col" role="columnheader"></th>
      </tr>
    </ng-container>
    <ng-template body>
      <tr bitRow *ngFor="let device of dataSource.data">
        <td bitCell class="tw-flex tw-gap-2">
          <div class="tw-flex tw-items-center tw-justify-center tw-w-10">
            <i [class]="getDeviceIcon(device.type)" class="bwi-lg" aria-hidden="true"></i>
          </div>
          <div>
            {{ device.displayName }}
            <span *ngIf="device.trusted" class="tw-text-sm tw-text-muted tw-block">
              {{ "trusted" | i18n }}
            </span>
          </div>
        </td>
        <td bitCell>
          <span *ngIf="isCurrentDevice(device)" bitBadge variant="primary">{{
            "currentSession" | i18n
          }}</span>
          <span *ngIf="hasPendingAuthRequest(device)" bitBadge variant="warning">{{
            "requestPending" | i18n
          }}</span>
        </td>
        <td bitCell>{{ device.firstLogin | date: "medium" }}</td>
        <td bitCell>
          <button
            type="button"
            bitIconButton="bwi-ellipsis-v"
            [bitMenuTriggerFor]="optionsMenu"
          ></button>
          <bit-menu #optionsMenu>
            <button
              type="button"
              bitMenuItem
              (click)="approveDevice(device)"
              *ngIf="device.loginStatus && !isCurrentDevice(device)"
            >
              <i class="bwi bwi-check" aria-hidden="true"></i>
              {{ "approveRequest" | i18n }}
            </button>
            <button
              type="button"
              bitMenuItem
              (click)="logOutDevice(device)"
              [disabled]="isCurrentDevice(device)"
            >
              <i aria-hidden="true" class="bwi bwi-fw bwi-sign-out"></i>
              {{ "logOut" | i18n }}
            </button>
            <button
              type="button"
              bitMenuItem
              (click)="removeDevice(device)"
              [disabled]="isCurrentDevice(device)"
            >
              <span class="tw-text-danger">
                <i class="bwi bwi-trash" aria-hidden="true"></i>
                {{ "remove" | i18n }}
              </span>
            </button>
          </bit-menu>
        </td>
      </tr>
    </ng-template>
  </bit-table>
</div>
